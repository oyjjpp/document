# 数据一致性

## 什么是”数据⼀致性“

```mysql
⾸先，“数据⼀致”⼀般指的是：缓存中有数据，缓存的数据值 = 数据库中的值。 但根据缓存中是有数据为依据，则”⼀致“可以包含两种情况： 缓存中有数据，缓存的数据值 = 数据库中的值 缓存中本没有数据，数据库中的值 = 最新值（有请求查询数据库时，会将数据写⼊缓存，则变为上⾯的“⼀ 致”状态） ”数据不⼀致“：缓存的数据值 ≠ 数据库中的值；缓存或者数据库中存在旧值，导致其他线程读到旧数据
```

## 数据不⼀致情况及应对策略

```mysql
根据是否接收写请求，可以把缓存分成读写缓存和只读缓存。

只读缓存：只在缓存进⾏数据查找，即使⽤ “更新数据库+删除缓存” 策略；

读写缓存：需要在缓存中对数据进⾏增删改查，即使⽤ “更新数据库+更新缓存”策略。
```

## 建议

```mysql
优先使用“先更新数据库再删除缓存”的执行时序，
原因主要有两个： 
1. 先删除缓存值再更新数据库，有可能导致请求因缓存缺失⽽访问数据库，给数据库带来压力； 
2. 业务应用中读取数据库和写缓存的时间有时不好估算，进⽽导致延迟双删中的sleep时间不好设置。
```

[如何保持mysql和redis中数据的一致性？
](https://www.zhihu.com/question/319817091/answer/2176813916)
